<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>‚öîÔ∏è Batalha - Magis Adventure</title>
  <style>
    body {
      margin: 0; padding: 0;
      background: url("img/fundo_batalha.jpg") no-repeat center center fixed;
      background-size: cover;
      font-family: 'Segoe UI', sans-serif;
      color: white; text-align: center;
    }
    .container {
      background: rgba(0,0,0,0.8);
      margin: 40px auto; padding: 30px;
      border-radius: 16px; max-width: 600px;
      position: relative; overflow: hidden;
    }
    h1 { margin-bottom: 20px; }
    .info-jogador, .info-chefe {
      margin: 20px 0;
    }
    .info-jogador img, .info-chefe img {
      width: 120px; border-radius: 8px; border: 2px solid #00b4d8;
    }
    .barra-vida {
      background: #555; border-radius: 10px;
      height: 20px; width: 100%; margin: 10px 0; overflow: hidden;
    }
    .vida {
      background: #ff6363; height: 100%; width: 100%;
      transition: width 0.5s ease;
    }
    .botoes button {
      display: inline-block; margin: 10px;
      padding: 12px 25px; border: none; border-radius: 8px;
      background: #00b4d8; color: white; cursor: pointer;
      transition: background 0.3s;
    }
    .botoes button:hover { background: #0096c7; }
    .status-ind {
      display: flex; justify-content: space-around;
      margin: 20px 0; font-size: 18px;
    }
    /* anima√ß√µes */
    @keyframes shake {
      0% { transform: translate(0,0); }
      20% { transform: translate(-5px,5px); }
      40% { transform: translate(5px,-5px); }
      60% { transform: translate(-5px,5px); }
      80% { transform: translate(5px,-5px); }
      100% { transform: translate(0,0); }
    }
    @keyframes confetti {
      0% { background-position: 0 0; }
      100% { background-position: 100% 100%; }
    }
    .shake { animation: shake 0.6s; }
    .confetti::before {
      content: "üéâ"; position: absolute; font-size: 5rem;
      top: 20%; left: 45%; animation: confetti 1s infinite;
    }
  </style>
</head>
<body>
  <div class="container" id="container">
    <h1>‚öîÔ∏è Batalha Contra o Boss</h1>

    <div class="info-jogador">
      <strong id="nomeUsuario"></strong><br>
      <img id="avatar" src="" alt="Avatar"><br>
      Vida: <div class="barra-vida"><div id="vidaJogador" class="vida"></div></div>
    </div>

    <div class="status-ind">
      <div>üó°Ô∏è QCs: <span id="qcs">0</span></div>
      <div>‚ú® For√ßa: <span id="forca">0</span></div>
    </div>

    <div class="botoes">
      <button onclick="playClick(); atacarComQCs()">Atacar com QCs</button>
      <button onclick="playClick(); atacarComForca()">Atacar com For√ßa</button>
    </div>

    <hr style="border-color:#444;margin:30px 0;">

    <div class="info-chefe">
      <strong id="nomeChefe"></strong><br>
      <img id="imgChefe" src="" alt="Chefe"><br>
      Vida: <div class="barra-vida"><div id="vidaChefe" class="vida"></div></div>
    </div>

    <div class="botoes">
      <button onclick="playClick(); fugir()">Fugir</button>
      <button onclick="playClick(); window.location.href='painel.html'">Voltar</button>
    </div>
  </div>

  <audio id="musica" src="audio/tema.mp3" autoplay loop></audio>
  <audio id="click" src="audio/click.mp3"></audio>

  <script>
    // sons
    function playClick() {
      const c = document.getElementById("click");
      c.currentTime = 0; c.play();
    }

    // dados iniciais
    const nome  = localStorage.getItem("nomeJogador")   || "Jogador";
    const avatar= localStorage.getItem("avatarJogador") || "heroi.png";
    const qcs   = parseInt(localStorage.getItem("qcs")  || 0);
    const forca = parseInt(localStorage.getItem("forca")|| 0);
    const chefes = [
      "Constitucio","Criminus Rex","Processus","Electoralis","Administratus",
      "Civis","Processus Civilis","Juvenis","Tributarius","Empresarius",
      "Ambientalis","Internationalis","Previdencialis","Economicus",
      "Consumidor","Humanitas","Protector Humanus"
    ];
    let vencidos = parseInt(localStorage.getItem("chefesVencidos")||0);
    let bossIdx = vencidos % chefes.length;
    let bossName = chefes[bossIdx];
    
    // exibir dados
    document.getElementById("nomeUsuario").textContent = nome;
    document.getElementById("avatar").src = "img/" + avatar;
    document.getElementById("qcs").textContent = qcs;
    document.getElementById("forca").textContent = forca;
    document.getElementById("nomeChefe").textContent = bossName;
    document.getElementById("imgChefe").src = "img/chefes/" +
      bossName.toLowerCase().replace(/ /g,'').replace(/rex/,'rex') + ".png";

    // vida
    let vidaJog = 100, vidaBoss = 100;
    function atualizarBarras(){
      document.getElementById("vidaJogador").style.width = vidaJog + "%";
      document.getElementById("vidaChefe").style.width    = vidaBoss+ "%";
    }
    atualizarBarras();

    function atacarComQCs(){
      if(qcs<=0) return alert("Sem QCs!");
      let dano = qcs;
      vidaBoss = Math.max(0, vidaBoss - dano);
      localStorage.setItem("qcs", 0);
      document.getElementById("qcs").textContent = 0;
      contraAtaque();
    }

    function atacarComForca(){
      if(forca<=0) return alert("Sem For√ßa!");
      let dano = forca;
      vidaBoss = Math.max(0, vidaBoss - dano);
      localStorage.setItem("forca", 0);
      document.getElementById("forca").textContent = 0;
      contraAtaque();
    }

    function contraAtaque(){
      atualizarBarras();
      if(vidaBoss===0){ vencer(); return; }
      // boss ataca
      let dano = Math.floor(Math.random()*15)+5;
      vidaJog = Math.max(0, vidaJog - dano);
      atualizarBarras();
      if(vidaJog===0){ perder(); }
    }

    function vencer(){
      const cont = document.getElementById("container");
      cont.classList.add("confetti");
      playClick();
      alert("Voc√™ venceu "+ bossName +"! +50 XP");
      let xp = parseInt(localStorage.getItem("xp")||0)+50;
      localStorage.setItem("xp", xp);
      localStorage.setItem("chefesVencidos", vencidos+1);
    }

    function perder(){
      const cont = document.getElementById("container");
      cont.classList.add("shake");
      playClick();
      alert("Voc√™ foi derrotado por "+ bossName +"!");
    }

    function fugir(){
      window.location.href="painel.html";
    }
  </script>
</body>
</html>
